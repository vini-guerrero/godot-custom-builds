name: UWP Build
# on: [push]
on: [workflow_dispatch]

env:
  GODOT_BRANCH: 3.3
  SCONS_CACHE_LIMIT: 4096
  SCONS_CACHE: ${{github.workspace}}/.scons_cache/

jobs:
  build:
    name: Build UWP Engine
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v2
      - name: Checkout Godot Engine
        uses: actions/checkout@v2
        with:
          repository: godotengine/godot
          ref: ${{env.GODOT_BRANCH}}
      - name: Prepare Build
        run: |
          wget -c https://raw.githubusercontent.com/godotengine/godot/ebe2e22ad45d62da476663607ddda75dd1fff18a/platform/uwp/detect.py -O platform/uwp/detect.py
          wget -c https://raw.githubusercontent.com/godotengine/godot/ebe2e22ad45d62da476663607ddda75dd1fff18a/platform/uwp/context_egl_uwp.cpp -O platform/uwp/context_egl_uwp.cpp
          ls -l platform/uwp

      # - name: Load .scons_cache directory
      #   id: Editor-Cache
      #   uses: actions/cache@v2
      #   with:
      #     path: ${{github.workspace}}/.scons_cache/
      #     key: ${{github.job}}-${{env.GODOT_BRANCH}}-${{github.ref}}-${{github.sha}}
      #     restore-keys: |
      #       ${{github.job}}-${{env.GODOT_BRANCH}}-${{github.ref}}-${{github.sha}}
      #       ${{github.job}}-${{env.GODOT_BRANCH}}-${{github.ref}}
      #       ${{github.job}}-${{env.GODOT_BRANCH}}
